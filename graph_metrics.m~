clear all;
% addpath /home/anirudh/Softwares/BCT/2015_01_25' BCT';
% lesions = [24;2;7;30;29;8;27;3;17;10;23;58;36;41;64;63;42;61;37;51;44;57];
% disp('WARNING:This script assumes that first element of scPaths/fcPaths is healthy control');
% % scPaths = {'../../data/connectivity_68/Human_68.hdf5'};
% scPaths = {'../../data/connectivity_68/Human_68.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_24_rPCUN.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_2_rCAC.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_7_rIP.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_30_rSMAR.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_29_rST.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_8_rIT.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_27_rSF.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_3_rCMF.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_17_rPOPE.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_10_rLOCC.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_23_rPREC.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_58_lPCUN.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_36_lCAC.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_41_lIP.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_64_lSMAR.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_63_lST.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_42_lIT.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_61_lSF.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_37_lCMF.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_51_lPOPE.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_44_lLOCC.hdf5',...
%         '../../data/connectivity_68/lesioned/sc_57_lPREC.hdf5'};
% % fcPaths = {'../../results/68/fc_hc_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_24_rPCUN_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_2_rCAC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_7_rIP_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_30_rSMAR_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_29_rST_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_8_rIT_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_27_rSF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_3_rCMF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_17_rPOPE_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_10_rLOCC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_23_rPREC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_58_lPCUN_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_36_lCAC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_41_lIP_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_64_lSMAR_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_63_lST_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_42_lIT_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_61_lSF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_37_lCMF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_51_lPOPE_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_44_lLOCC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/fc_57_lPREC_G0.15_wofic_nn4.hdf5'};  
% % regionNamesPath = '../../data/connectivity_68/fs_region_abbrev_sort.txt';
% hdf5SavePaths = {'../../results/68/graph_metrics/gm_sc_hc.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_24_rPCUN.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_2_rCAC.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_7_rIP.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_30_rSMAR.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_29_rST.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_8_rIT.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_27_rSF.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_3_rCMF.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_17_rPOPE.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_10_rLOCC.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_23_rPREC.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_58_lPCUN.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_36_lCAC.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_41_lIP.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_64_lSMAR.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_63_lST.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_42_lIT.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_61_lSF.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_37_lCMF.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_51_lPOPE.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_44_lLOCC.hdf5',...
%                '../../results/68/graph_metrics/gm_sc_57_lPREC.hdf5'};
% % hdf5SavePaths = {'../../results/68/graph_metrics/gm_fc_hc_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_24_rPCUN_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_2_rCAC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_7_rIP_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_30_rSMAR_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_29_rST_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_8_rIT_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_27_rSF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_3_rCMF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_17_rPOPE_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_10_rLOCC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_23_rPREC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_58_lPCUN_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_36_lCAC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_41_lIP_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_64_lSMAR_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_63_lST_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_42_lIT_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_61_lSF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_37_lCMF_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_51_lPOPE_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_44_lLOCC_G0.15_wofic_nn4.hdf5',...
% %             '../../results/68/graph_metrics/gm_fc_57_lPREC_G0.15_wofic_nn4.hdf5'};
% connectivityType = 'structural';
% csvSavePath = '../../results/68/graph_metrics/gm_sc.csv';
% if(strcmp(connectivityType,'structural'))
%     csvTitle = {'Data' 'Assortativity' 'Global Efficiency' 'Modularity' 'Path Length' 'Clustering Coeff' 'Degree' 'In Degree' 'Out Degree' 'Edge Betweenness Centrality' 'Node Betweenness Centrality'};
%     dataPaths = scPaths;
% elseif(strcmp(connectivityType,'functional'))
%     csvTitle = {'Data' 'Modularity'};
%     dataPaths = fcPaths;
% end
% 
% fid = fopen(csvSavePath,'w');
% for i = 1:length(csvTitle)
%     if (i ~= length(csvTitle))
%         fprintf(fid,sprintf('%s',[csvTitle{i},'\t']));
%     else
%         fprintf(fid,sprintf('%s',[csvTitle{i},'\n']));
%     end
% end
% for i = 1:length(dataPaths)
%     if (strcmp(connectivityType,'structural') && i ~= 1)
%         compute_graph_metrics(connectivityType,dataPaths{i},hdf5SavePaths{i});
%         assortativity = h5read(hdf5SavePaths{i},'/Assortativity');
%         efficiency = h5read(hdf5SavePaths{i},'/GlobalEfficiency');
%         modularity = h5read(hdf5SavePaths{i},'/Modularity');
%         pathLength = h5read(hdf5SavePaths{i},'/PathLength');
%         if(exist(hdf5SavePaths{i},'file'))
%             rmCmd = strcat(['rm ',hdf5SavePaths{i}]);
%             system(rmCmd);
%         end
%         h5create(hdf5SavePaths{i},'/Assortativity',size(assortativity));
%         h5write(hdf5SavePaths{i},'/Assortativity',assortativity);
%         h5create(hdf5SavePaths{i},'/PathLength',size(pathLength));
%         h5write(hdf5SavePaths{i},'/PathLength',pathLength);
%         h5create(hdf5SavePaths{i},'/GlobalEfficiency',size(efficiency));
%         h5write(hdf5SavePaths{i},'/GlobalEfficiency',efficiency);
%         h5create(hdf5SavePaths{i},'/Modularity',size(modularity));
%         h5write(hdf5SavePaths{i},'/Modularity',modularity);
%         nbrs = h5read(dataPaths{i},'/Neighbours');
%         t = h5read(hdf5SavePaths{1},'/ClusteringCoefficient');
%         clstrCoeff = mean(t(nbrs));
%         h5create(hdf5SavePaths{i},'/ClusteringCoefficient',size(clstrCoeff));
%         h5write(hdf5SavePaths{i},'/ClusteringCoefficient',clstrCoeff);
%         t = h5read(hdf5SavePaths{1},'/Degree');
%         degree = mean(t(nbrs));
%         t = h5read(hdf5SavePaths{1},'/InDegree');
%         inDegree = mean(t(nbrs));
%         t = h5read(hdf5SavePaths{1},'/OutDegree');
%         outDegree = mean(t(nbrs));
%         h5create(hdf5SavePaths{i},'/InDegree',size(inDegree));
%         h5write(hdf5SavePaths{i},'/InDegree',inDegree);
%         h5create(hdf5SavePaths{i},'/OutDegree',size(outDegree));
%         h5write(hdf5SavePaths{i},'/OutDegree',outDegree);
%         h5create(hdf5SavePaths{i},'/Degree',size(degree));
%         h5write(hdf5SavePaths{i},'/Degree',degree);
%         t = h5read(hdf5SavePaths{1},'/EdgeBetweennessCentrality');
%         ebc = mean(mean([t(:,nbrs) t(nbrs,:)']));
%         h5create(hdf5SavePaths{i},'/EdgeBetweennessCentrality',size(ebc));
%         h5write(hdf5SavePaths{i},'/EdgeBetweennessCentrality',ebc);
%         t = h5read(hdf5SavePaths{1},'/NodeBetweennessCentrality');
%         nbc = mean(t(nbrs));
%         h5create(hdf5SavePaths{i},'/NodeBetweennessCentrality',size(nbc));
%         h5write(hdf5SavePaths{i},'/NodeBetweennessCentrality',nbc);
%         graphMetrics = [assortativity efficiency modularity pathLength clstrCoeff degree inDegree outDegree ebc nbc];
%         fprintf(fid,'%s\t',dataPaths{i});
%         fprintf(fid,sprintf('%.4d\t',graphMetrics));
%         fprintf(fid,sprintf('%s','\n'));
%     elseif(strcmp(connectivityType,'structural'))
%         compute_graph_metrics(connectivityType,dataPaths{i},hdf5SavePaths{i});
%         assortativity = h5read(hdf5SavePaths{i},'/Assortativity');
%         efficiency = h5read(hdf5SavePaths{i},'/GlobalEfficiency');
%         modularity = h5read(hdf5SavePaths{i},'/Modularity');
%         pathLength = h5read(hdf5SavePaths{i},'/PathLength');
%         graphMetrics = [assortativity efficiency modularity pathLength];
%         fprintf(fid,'%s\t',dataPaths{i});
%         fprintf(fid,sprintf('%.4d\t',graphMetrics));
%         fprintf(fid,sprintf('%s','\n'));
%     elseif(strcmp(connectivityType,'functional'))
%         compute_graph_metrics(connectivityType,dataPaths{i},hdf5SavePaths{i});
%         modularity = h5read(hdf5SavePaths{i},'/Modularity');
%         graphMetrics = [modularity];
%         fprintf(fid,'%s\t',dataPaths{i});
%         fprintf(fid,sprintf('%.4d\t',graphMetrics));
%         fprintf(fid,sprintf('%s','\n'));
%     end
% end
% fclose(fid);

scPaths = {'sc_1_BSTS_nn1.hdf5',...
'sc_2_CAC_nn1.hdf5',...
'sc_3_CMF_nn1.hdf5',...
'sc_4_CUN_nn1.hdf5',...
'sc_5_ENT_nn1.hdf5',...
'sc_6_FUS_nn1.hdf5',...
'sc_7_IP_nn1.hdf5',...
'sc_8_IT_nn1.hdf5',...
'sc_9_ISTH_nn1.hdf5',...
'sc_10_LOCC_nn1.hdf5',...
'sc_11_LOF_nn1.hdf5',...
'sc_12_LING_nn1.hdf5',...
'sc_13_MOF_nn1.hdf5',...
'sc_14_MT_nn1.hdf5',...
'sc_15_PARH_nn1.hdf5',...
'sc_16_PARC_nn1.hdf5',...
'sc_17_POPE_nn1.hdf5',...
'sc_18_PORB_nn1.hdf5',...
'sc_19_PTRI_nn1.hdf5',...
'sc_20_PCAL_nn1.hdf5',...
'sc_21_PCNT_nn1.hdf5',...
'sc_22_PC_nn1.hdf5',...
'sc_23_PREC_nn1.hdf5',...
'sc_24_PCUN_nn1.hdf5',...
'sc_25_RAC_nn1.hdf5',...
'sc_26_RMF_nn1.hdf5',...
'sc_27_SF_nn1.hdf5',...
'sc_28_SP_nn1.hdf5',...
'sc_29_ST_nn1.hdf5',...
'sc_30_SMAR_nn1.hdf5',...
'sc_31_FP_nn1.hdf5',...
'sc_32_TP_nn1.hdf5',...
'sc_33_TT_nn1.hdf5',...
'sc_34_INS_nn1.hdf5',...
'sc_35_BSTS_nn1.hdf5',...
'sc_36_CAC_nn1.hdf5',...
'sc_37_CMF_nn1.hdf5',...
'sc_38_CUN_nn1.hdf5',...
'sc_39_ENT_nn1.hdf5',...
'sc_40_FUS_nn1.hdf5',...
'sc_41_IP_nn1.hdf5',...
'sc_42_IT_nn1.hdf5',...
'sc_43_ISTH_nn1.hdf5',...
'sc_44_LOCC_nn1.hdf5',...
'sc_45_LOF_nn1.hdf5',...
'sc_46_LING_nn1.hdf5',...
'sc_47_MOF_nn1.hdf5',...
'sc_48_MT_nn1.hdf5',...
'sc_49_PARH_nn1.hdf5',...
'sc_50_PARC_nn1.hdf5',...
'sc_51_POPE_nn1.hdf5',...
'sc_52_PORB_nn1.hdf5',...
'sc_53_PTRI_nn1.hdf5',...
'sc_54_PCAL_nn1.hdf5',...
'sc_55_PCNT_nn1.hdf5',...
'sc_56_PC_nn1.hdf5',...
'sc_57_PREC_nn1.hdf5',...
'sc_58_PCUN_nn1.hdf5',...
'sc_59_RAC_nn1.hdf5',...
'sc_60_RMF_nn1.hdf5',...
'sc_61_SF_nn1.hdf5',...
'sc_62_SP_nn1.hdf5',...
'sc_63_ST_nn1.hdf5',...
'sc_64_SMAR_nn1.hdf5',...
'sc_65_FP_nn1.hdf5',...
'sc_66_TP_nn1.hdf5',...
'sc_67_TT_nn1.hdf5',...
'sc_68_INS_nn1.hdf5'};

fcPathsFICPrior = {'fc_1_BSTS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_2_CAC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_3_CMF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_4_CUN_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_5_ENT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_6_FUS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_7_IP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_8_IT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_9_ISTH_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_10_LOCC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_11_LOF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_12_LING_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_13_MOF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_14_MT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_15_PARH_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_16_PARC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_17_POPE_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_18_PORB_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_19_PTRI_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_20_PCAL_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_21_PCNT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_22_PC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_23_PREC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_24_PCUN_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_25_RAC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_26_RMF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_27_SF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_28_SP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_29_ST_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_30_SMAR_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_31_FP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_32_TP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_33_TT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_34_INS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_35_BSTS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_36_CAC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_37_CMF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_38_CUN_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_39_ENT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_40_FUS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_41_IP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_42_IT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_43_ISTH_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_44_LOCC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_45_LOF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_46_LING_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_47_MOF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_48_MT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_49_PARH_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_50_PARC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_51_POPE_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_52_PORB_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_53_PTRI_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_54_PCAL_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_55_PCNT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_56_PC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_57_PREC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_58_PCUN_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_59_RAC_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_60_RMF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_61_SF_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_62_SP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_63_ST_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_64_SMAR_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_65_FP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_66_TP_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_67_TT_nn1_G0.7_sigma0.001_ficprior_nn1_8mins',...
'fc_68_INS_nn1_G0.7_sigma0.001_ficprior_nn1_8mins'};

fcPathsFICPost = {'fc_1_BSTS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_2_CAC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_3_CMF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_4_CUN_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_5_ENT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_6_FUS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_7_IP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_8_IT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_9_ISTH_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_10_LOCC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_11_LOF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_12_LING_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_13_MOF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_14_MT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_15_PARH_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_16_PARC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_17_POPE_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_18_PORB_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_19_PTRI_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_20_PCAL_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_21_PCNT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_22_PC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_23_PREC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_24_PCUN_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_25_RAC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_26_RMF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_27_SF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_28_SP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_29_ST_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_30_SMAR_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_31_FP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_32_TP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_33_TT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_34_INS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_35_BSTS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_36_CAC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_37_CMF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_38_CUN_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_39_ENT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_40_FUS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_41_IP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_42_IT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_43_ISTH_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_44_LOCC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_45_LOF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_46_LING_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_47_MOF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_48_MT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_49_PARH_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_50_PARC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_51_POPE_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_52_PORB_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_53_PTRI_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_54_PCAL_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_55_PCNT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_56_PC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_57_PREC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_58_PCUN_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_59_RAC_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_60_RMF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_61_SF_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_62_SP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_63_ST_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_64_SMAR_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_65_FP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_66_TP_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_67_TT_nn1_G0.7_sigma0.001_ficpost_nn1_8mins',...
'fc_68_INS_nn1_G0.7_sigma0.001_ficpost_nn1_8mins'};

% fcPaths = fcPathsFICPrior;
% gmcsvPath = '../../results/68/graph_metrics/gm_sc.csv';
% fid = fopen(gmcsvPath,'w');
scEmpPath = '../../data/connectivity_68/SC_FC_all/FJ_20120808.hdf5';
% fcEmpPath = '../../data/connectivity_68/SC_FC_all/EU_20120803.hdf5';
scEmp = h5read(scEmpPath,'/C');
scEmpLen = weight_conversion(scEmp, 'lengths');
% fcEmp = h5read(fcEmpPath,'/CC');
t = load('../../results/68/optimalG_FJ_20120808_fic_dt1_sigma0.001_8mins_EI.mat','fcs');
fcEmp = t.fcs{28};
clear t;
% t = load('simhc_Deco66_G205.mat','fc');
% fcEmp = t.fc;
% t = load('~/Structure_Function_Lesion/results/68/sim_healthy_10runs.mat');
% fc_hc_sim = zeros(68,68);
% for i = 1:5
%     fc_hc_sim = fc_hc_sim + t.fcs{i};
% end
% fc_hc_sim = fc_hc_sim ./ 5;
% clear t;
% fprintf(fid,'%s\t','Node Betweennes Centrality');
% fprintf(fid,'%s\t','ClusteringCoefficient');

% Node Betweenness Centrality
nbc = betweenness_wei(scEmpLen);
%Clustering Coefficient
clstrCoef = clustering_coef_wd(scEmp);
%Participation Coefficient
[commStrucSCEmp,modulSCEmp] = community_louvain(scEmp,1);
partCoefSCEmp = participation_coef(scEmp,commStrucSCEmp,1);
partCoefSCEmpNbrs = zeros(size(partCoefSCEmp));
lesionStrengths = zeros(length(scPaths),1);
modulsFICPrior = zeros(length(fcPathsFICPrior),1);
modulsFICPost = zeros(length(fcPathsFICPost),1);
fcCorrsFICPrior = zeros(length(fcPathsFICPrior),1);
fcCorrsFICPost = zeros(length(fcPathsFICPost),1);
fcCorrsLesionedFICPrior = zeros(length(fcPathsFICPrior),1);
fcCorrsLesionedFICPost = zeros(length(fcPathsFICPost),1);
fcDistancePrior = zeros(length(fcPathsFICPrior),1);
fcDistancePost= zeros(length(fcPathsFICPost),1);
zscrPrior = zeros(length(fcPathsFICPrior),1);
zscrPost = zeros(length(fcPathsFICPost),1);
for i = 1:length(fcPathsFICPrior)
    avgFCPrior = h5read(['../../results/68/FJ/' fcPathsFICPrior{i}],'/CC');
    avgFCPost = h5read(['../../results/68/FJ/' fcPathsFICPost{i}],'/CC');
    nbrs = h5readatt(['../../data/connectivity_68/SC_FC_all/lesioned/FJ/' scPaths{i}],'/C','LesionIdx');
    lesionStrengths(i) = lesion_strength(scEmp,nbrs);
    partCoefSCEmpNbrs(i) = sum(partCoefSCEmp(nbrs));
%     [commstrucFCPrior,modulFICPrior] = modularity_und(avgFCPrior);
%     [commstrucFCPost,modulFICPost] = modularity_und(avgFCPost);
    [commstrucFCPrior,modulFICPrior] = modularity_louvain_und_sign(avgFCPrior,'sta');
    [commstrucFCPost,modulFICPost] = modularity_louvain_und_sign(avgFCPost,'sta');
    modulsFICPrior(i) = modulFICPrior;
    modulsFICPost(i) = modulFICPost;
%     fcCorrsFICPrior(i) = find_corr(fcEmp,avgFCPrior);
%     nbrs = h5read(scPaths{i},'/Neighbours');
    fcCorrsLesionedFICPrior(i) = find_corr_lesioned(fcEmp,avgFCPrior,nbrs);
%     fcCorrsFICPost(i) = find_corr(fcEmp,avgFCPost);
%     nbrs = h5read(scPaths{i},'/Neighbours');
    fcCorrsLesionedFICPost(i) = find_corr_lesioned(fcEmp,avgFCPost,nbrs);
    fcDistancePrior(i) = fc_distance(avgFCPrior,fcEmp,nbrs);
    fcDistancePost(i) = fc_distance(avgFCPost,fcEmp,nbrs);
%     t = compute_zscores(fc_hc_sim,avgFCPrior);
%     zscrPrior(i) = size(find(abs(t)>2),1);
%     t = compute_zscores(fc_hc_sim,avgFCPost);
%     zscrPost(i) = size(find(abs(t)>2),1);
end
% figure();
% subplot(2,2,1);
% hold on;
% xlabel('Lesion Strength')
% ylabel('FC\_Emp vs FC\_Sim Correlation')
% r = corrcoef(lesionStrengths,fcCorrsLesionedFICPrior);
% r = r(1,2);
% p=polyfit(lesionStrengths,fcCorrsLesionedFICPrior,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,fcCorrsLesionedFICPrior,'bo');
% plot(lesionStrengths,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(lesionStrengths,fcCorrsLesionedFICPost);
% r = r(1,2);
% p=polyfit(lesionStrengths,fcCorrsLesionedFICPost,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,fcCorrsLesionedFICPost,'ko');a
% plot(lesionStrengths,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')



% subplot(2,2,2);
% hold on;
% xlabel('Node Betweenness Centrality')
% ylabel('FC\_Emp vs FC\_Sim Correlation')
% r = corrcoef(nbc,fcCorrsFICPrior);
% r = r(1,2);
% p=polyfit(nbc,fcCorrsFICPrior,1);
% pred = polyval(p,nbc);
% plot(nbc,fcCorrsFICPrior,'bo');
% plot(nbc,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(nbc,fcCorrsFICPost);
% r = r(1,2);
% p=polyfit(nbc,fcCorrsFICPost,1);
% pred = polyval(p,nbc);
% plot(nbc,fcCorrsFICPost,'ko');
% plot(nbc,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')

% subplot(1,2,1);
% hold on;
% xlabel('Participation Coefficient')
% ylabel('FC\_Emp vs FC\_Sim Correlation')
% r = corrcoef(partCoefSCEmp,fcCorrsLesionedFICPrior);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,fcCorrsLesionedFICPrior,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,fcCorrsLesionedFICPrior,'bo');
% plot(partCoefSCEmp,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(partCoefSCEmp,fcCorrsLesionedFICPost);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,fcCorrsLesionedFICPost,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,fcCorrsLesionedFICPost,'ko');
% plot(partCoefSCEmp,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')
% 
% 
% 
% subplot(1,2,1);
% hold on;
% xlabel('Lesion Strength')
% ylabel('Modularity')
% r = corrcoef(lesionStrengths,modulsFICPrior);
% r = r(1,2);
% p=polyfit(lesionStrengths,modulsFICPrior,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,modulsFICPrior,'bo');
% plot(lesionStrengths,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(lesionStrengths,modulsFICPost);
% r = r(1,2);
% p=polyfit(lesionStrengths,modulsFICPost,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,modulsFICPost,'ko');
% plot(lesionStrengths,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')
% 
% 
% subplot(1,2,2);
% hold on;
% xlabel('Participation Coefficient')
% ylabel('Modularity')
% r = corrcoef(partCoefSCEmp,modulsFICPrior);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,modulsFICPrior,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,modulsFICPrior,'bo');
% plot(partCoefSCEmp,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(partCoefSCEmp,modulsFICPost);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,modulsFICPost,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,modulsFICPost,'ko');
% plot(partCoefSCEmp,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')


% subplot(1,2,1);
% hold on;
% xlabel('Lesion Strength')
% ylabel('Z-scores')
% r = corrcoef(lesionStrengths,zscrPrior);
% r = r(1,2);
% p=polyfit(lesionStrengths,zscrPrior,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,zscrPrior,'bo');
% plot(lesionStrengths,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(lesionStrengths,zscrPost);
% r = r(1,2);
% p=polyfit(lesionStrengths,zscrPost,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,zscrPost,'ko');
% plot(lesionStrengths,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')
% 
% 
% subplot(1,2,2);
% hold on;
% xlabel('Participation Coefficient')
% ylabel('Z-Scores')
% r = corrcoef(partCoefSCEmp,zscrPrior);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,zscrPrior,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,zscrPrior,'bo');
% plot(partCoefSCEmp,pred,'b');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','b')
% 
% r = corrcoef(partCoefSCEmp,zscrPost);
% r = r(1,2);
% p=polyfit(partCoefSCEmp,zscrPost,1);
% pred = polyval(p,partCoefSCEmp);
% plot(partCoefSCEmp,zscrPost,'ko');
% plot(partCoefSCEmp,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')



% 
% 
% 
% figure();
% % subplot(2,2,4);
% hold on;
% xlabel('Node Betweenness Centrality')
% ylabel('Modularity')
% [rho,pVal] = corrcoef(nbc,fcDistancePrior);
% rho = rho(1,2);
% pVal = pVal(1,2);
% p=polyfit(nbc,fcDistancePrior,1);
% pred = polyval(p,nbc);
% plot(nbc,fcDistancePrior,'bo');
% plot(nbc,pred,'b');
% gtext(['r=',sprintf('%.2f',rho),', p=',sprintf('%.2f',pVal)],'FontSize',15,'Color','b')
% 
% [rho,pVal] = corrcoef(nbc,fcDistancePost);
% rho = rho(1,2);
% pVal = pVal(1,2);
% p=polyfit(nbc,fcDistancePost,1);
% pred = polyval(p,nbc);
% plot(nbc,fcDistancePost,'ko');
% plot(nbc,pred,'k');
% gtext(['r=',sprintf('%.2f',rho),', p=',sprintf('%.2f',pVal)],'FontSize',15,'Color','k')



% subplot(1,2,1);
% hold on;
% xlabel('Node Betweenness Centrality')
% ylabel('FC Distance','FontSize',15)
% r = corrcoef(clstrCoef,fcDistancePrior);
% r = r(1,2);
% p=polyfit(clstrCoef,fcDistancePrior,1);
% pred = polyval(p,clstrCoef);
% plot(clstrCoef,fcDistancePrior,'bo');
% plot(clstrCoef,pred,'b');
% % text(6,800,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','b')
% gtext(['r=',sprintf('%.2f',r)],'FontSize',20,'Color','b');
% 
% r = corrcoef(clstrCoef,fcDistancePost);
% r = r(1,2);
% p=polyfit(clstrCoef,fcDistancePost,1);
% pred = polyval(p,clstrCoef);
% plot(clstrCoef,fcDistancePost,'ko');
% plot(clstrCoef,pred,'k');
% gtext(['r=',sprintf('%.2f',r)],'FontSize',13,'Color','k')
% figure();


% subplot(1,1,1);
% hold on;
% rectangle('position',[2.4 27.4 1.5 2.3],'facecolor','w');
% xlabel('Lesion Strength','FontWeight','bold','FontSize',15)
% ylabel('FC Distance','FontWeight','bold','FontSize',15)
% [rho1,pVal1] = corrcoef(lesionStrengths,fcDistancePrior);
% rho1 = rho1(1,2);
% pVal1 = pVal1(1,2);
% p=polyfit(lesionStrengths,fcDistancePrior,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,fcDistancePrior,'ko','MarkerFaceColor','k','MarkerSize',5);
% plot(lesionStrengths,pred,'k');
% text(2.5,29,sprintf('r=%.2f, p<%.3f',rho1,0.001),'FontSize',15,'Color','k')
% % text(6,29,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','b')
% % gtext(['r=',sprintf('%.2f, ',rho),'p=',sprintf('%.2f ',pVal)],'FontSize',15,'Color','b');
% 
% [rho2,pVal2] = corrcoef(lesionStrengths,fcDistancePost);
% rho2 = rho2(1,2);
% pVal2 = pVal2(1,2);
% p=polyfit(lesionStrengths,fcDistancePost,1);
% pred = polyval(p,lesionStrengths);
% plot(lesionStrengths,fcDistancePost,'bo','MarkerFaceColor','b','MarkerSize',5);
% plot(lesionStrengths,pred,'b');
% text(2.5,28,sprintf('r=%.2f, p=%.2f',rho2,pVal2),'FontSize',15,'Color','b')
% xlim([0 4])
% ylim([5 30])
% set(gca,'XTick',[0:0.5:4],'YTick',[5:5:30],'FontSize',13)
% % text(2.5,29,sprintf('r=%.2f,p=%.2f\nr=%.2f,p=%.2f',rho1,pVal1,rho2,pVal2),'FontSize',15,'Color','b','BackgroundColor',[1 1 1],'EdgeColor',[0 0 0])
% % text(6,27,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','k')
% % gtext(['r=',sprintf('%.2f, ',rho),'p=',sprintf('%.2f ',pVal)],'FontSize',15,'Color','k');
%

subplot(1,2,1);
hold on;
% rectangle('position',[0.44 27.5 0.25 2.3],'facecolor','w');
xlabel('Lesion Strength','FontWeight','bold','FontSize',15)
ylabel('FC Distance','FontSize',15,'FontWeight','bold')
[rho1,pVal1] = corrcoef(lesionStrengths,fcDistancePrior);
rho1 = rho1(1,2);
pVal1 = pVal1(1,2);
p = polyfit(lesionStrengths,fcDistancePrior,1);
pred = polyval(p,lesionStrengths);
plot(lesionStrengths,fcDistancePrior,'ko','MarkerFaceColor','k','MarkerSize',5);
plot(lesionStrengths,pred,'k');
% text(0.45,29,['r=',sprintf('%.2f, ',rho1),'p<',sprintf('%.3f ',0.001)],'FontSize',15,'Color','k')
% text(0.6,29,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','k')
gtext(['r=',sprintf('%.2f, ',rho1),'p=',sprintf('%.2f ',pVal1)],'FontSize',15,'Color','k');

[rho2,pVal2] = corrcoef(lesionStrengths,fcDistancePost);
rho2 = rho2(1,2);
pVal2 = pVal2(1,2);
p=polyfit(lesionStrengths,fcDistancePost,1);
pred = polyval(p,lesionStrengths);
plot(lesionStrengths,fcDistancePost,'bo','MarkerFaceColor','b','MarkerSize',5);
plot(lesionStrengths,pred,'b');
% xlim([0 0.7])
% ylim([5 30])
% set(gca,'XTick',[0:0.2:0.7],'YTick',[5:5:30],'FontSize',13)
% text(0.45,28,['r=',sprintf('%.2f, ',rho2),'p=',sprintf('%.2f ',pVal2)],'FontSize',15,'Color','b')
% text(0.6,27,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','b')
gtext(['r=',sprintf('%.2f, ',rho2),'p=',sprintf('%.2f ',pVal2)],'FontSize',15,'Color','b');


subplot(1,2,2);
hold on;
% rectangle('position',[0.44 27.5 0.25 2.3],'facecolor','w');
xlabel('Participation Coefficient','FontWeight','bold','FontSize',15)
ylabel('FC Distance','FontSize',15,'FontWeight','bold')
[rho1,pVal1] = corrcoef(partCoefSCEmp,fcDistancePrior);
rho1 = rho1(1,2);
pVal1 = pVal1(1,2);
p = polyfit(partCoefSCEmp,fcDistancePrior,1);
pred = polyval(p,partCoefSCEmp);
plot(partCoefSCEmp,fcDistancePrior,'ko','MarkerFaceColor','k','MarkerSize',5);
plot(partCoefSCEmp,pred,'k');
% text(0.45,29,['r=',sprintf('%.2f, ',rho1),'p<',sprintf('%.3f ',0.001)],'FontSize',15,'Color','k')
% text(0.6,29,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','k')
gtext(['r=',sprintf('%.2f, ',rho1),'p=',sprintf('%.2f ',pVal1)],'FontSize',15,'Color','k');

[rho2,pVal2] = corrcoef(partCoefSCEmp,fcDistancePost);
rho2 = rho2(1,2);
pVal2 = pVal2(1,2);
p=polyfit(partCoefSCEmp,fcDistancePost,1);
pred = polyval(p,partCoefSCEmp);
plot(partCoefSCEmp,fcDistancePost,'bo','MarkerFaceColor','b','MarkerSize',5);
plot(partCoefSCEmp,pred,'b');
% xlim([0 0.7])
% ylim([5 30])
% set(gca,'XTick',[0:0.2:0.7],'YTick',[5:5:30],'FontSize',13)
% text(0.45,28,['r=',sprintf('%.2f, ',rho2),'p=',sprintf('%.2f ',pVal2)],'FontSize',15,'Color','b')
% text(0.6,27,['r=',sprintf('%.2f',r)],'FontSize',20,'Color','b')
gtext(['r=',sprintf('%.2f, ',rho2),'p=',sprintf('%.2f ',pVal2)],'FontSize',15,'Color','b');


